[toc]

# 分区

## 概述
> 1. Linux 中无论有几个分区，分给哪一个目录使用，它归根结底都只有一个根目录，一个独立且唯一的文件结构。Linux 中每个分区都是用来组成整个文件系统的一部分。
> 2. Linux 采用了一种叫“挂载”的处理方式。它的整个文件系统中包含了一整套的文件和目录，且将一个分区和一个目录对应起来。这时要载入一个分区将使它的存储空间在一个目录下获得。

![](?.png)

## 硬盘
1. Linux 硬盘分为 IDE 硬盘和 SCSI 硬盘。目前基本上是 SCSI 硬盘。
2. 对于 IDE 硬盘，其驱动标识符为 “hdx~”。其中“hd”表明分区所在设备的类型，这里是指 IDE 硬盘；“x”为盘号（a 为基本盘，b 为基本从属盘，c 为辅助盘，d 为辅助从属盘）；“~”表示分区，前四个分区用数字 1 - 4 表示，它们是主分区或扩展分区，从 5 开始就是逻辑分区。
3. 对于 SCSI 硬盘，其驱动标识符为 “sdx~”。其中“sd”表明分区所在设备的类型；“x”为盘号（a 为基本盘，b 为基本从属盘，c 为辅助盘，d 为辅助从属盘）；“~”表示分区，前四个分区用数字 1 - 4 表示，它们是主分区或扩展分区，从 5 开始就是逻辑分区。

## 查看所有设备挂载情况
~~~
lsblk [-f]
~~~

## 案例

> 增加一块磁盘：
>
>  	1. 虚拟机添加硬盘：
>  	1. 分区；
>  	1. 格式化；
>  	1. 挂载
>  	1. 设置可以自动挂载

### 1. 虚拟机添加硬盘

在 [虚拟机] 菜单中，选择 [设置]，在设备列表里添加硬盘。最后<span style="color: red">重启系统(reboot)</span>才能生效。

### 2. 分区

#### 基本语法

~~~
fdisk /dev/sdb
~~~

#### 开始分区

| 指令 | 说明                      |
| ---- | ------------------------- |
| m    | 显示命令列表              |
| p    | 显示磁盘分区。同 fdisk -l |
| n    | 新增分区                  |
| d    | 删除分区                  |
| w    | 写入并退出                |
| q    | 不保存退出                |

##### 说明：

开始分区后，输入 n，然后输入 p，分区类型为主分区。两次回车默认剩余全部空间。最后输入 w，写入分区并退出。

### 3. 格式化磁盘

#### 基本语法

~~~
mkfs -t ext4 /dv/sdb1	// ext4 是分区类型。
~~~

### 4. 挂载：将一个分区与一个目录联系起来

~~~
mount 设备名 挂载目录
// mount /dev/sdb1 /newdisk
umount 设备名 / 挂载目录
// umount /dev/sdb1 / umount /newdisk
~~~

**<span style="color: red">注意：使用命令行挂载重启后会失效！</span>**

### 5. 永久挂载

通过修改 /etc/fstab 实现挂载。

添加完成后，执行 mount -a 即可生效。

# 磁盘情况查询

## 查询系统整体磁盘使用情况

### 基本语法

~~~
df -h	// 查询系统整体磁盘使用情况。
~~~

## 查询指定目录的磁盘占用情况

### 基本语法

~~~
du -h /目录	// 查询指定目录的磁盘占用情况，默认为当前目录。
~~~

| 选项         | 说明                     |
| ------------ | ------------------------ |
| -s           | 指定目录占用大小汇总     |
| -h           | 带计量单位               |
| -a           | 含文件                   |
| –max-depth=1 | 子目录深度               |
| -c           | 列出明细同时，增加汇总值 |

